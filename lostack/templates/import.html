{% extends "core.html" %}

{% block title %}Import Services - LoStack Admin{% endblock %}
{% block page_title %}Import Services{% endblock %}

{% block nav_actions %}
<a href="{{ url_for('services') }}" class="btn btn-secondary">
    <i class="bi bi-arrow-left me-1"></i>
    Back to Services
</a>
{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8 col-lg-6">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0">
                    <i class="bi bi-upload me-2"></i>
                    Import Service Configuration
                </h5>
            </div>
            <div class="card-body">
                <form method="POST" enctype="multipart/form-data">
                    <div class="mb-4">
                        <label for="config_file" class="form-label">Configuration File</label>
                        <input type="file" 
                               class="form-control" 
                               id="config_file" 
                               name="config_file" 
                               accept=".yml,.yaml"
                               required>
                        <div class="form-text">
                            Upload a YAML file containing service configurations.
                        </div>
                    </div>
                    
                    <div class="alert alert-info">
                        <h6 class="alert-heading">
                            <i class="bi bi-info-circle me-1"></i>
                            Expected Format
                        </h6>
                        <p class="mb-2">The YAML file should have the following structure:</p>
                        <pre class="small mb-0"><code>services:
  service-name:
    displayName: "Display Name"
    url: "http://service-name:8080/"
    # Optional fields:
    sessionDuration: "5m"
    theme: "ghost"
    refreshFrequency: "3s"
    showDetails: true</code></pre>
                    </div>
                    
                    <div class="alert alert-warning">
                        <h6 class="alert-heading">
                            <i class="bi bi-exclamation-triangle me-1"></i>
                            Import Notes
                        </h6>
                        <ul class="mb-0">
                            <li>Services with existing names will be skipped</li>
                            <li>Missing optional fields will use current defaults</li>
                            <li>Port will be extracted from the URL if possible</li>
                            <li>All imported services will be enabled by default</li>
                        </ul>
                    </div>
                    
                    <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                        <button type="submit" class="btn btn-primary w-100">
                            <i class="bi bi-upload me-1"></i>
                            Import Services
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// File input validation
document.getElementById('config_file').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (file && !file.name.toLowerCase().match(/\.(yml|yaml)$/)) {
        alert('Please select a YAML file (.yml or .yaml)');
        this.value = '';
    }
});
</script>
{% endblock %}